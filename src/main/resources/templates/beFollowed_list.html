<!DOCTYPE html>
<html lang="ZH-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>关注</title>
    <link rel="stylesheet" href="../static/css/maomao.css" th:href="@{/css/maomao.css}">
</head>
<body class="flex flex1 column" style="background-color: #e8e8e8;margin: 0">
<div class="m-backcolor">
    <div class="flex m-mg8">
        <div class="m-font-gray">返回</div>
        <div class="flex1" style="text-align: center;margin-left: -30px">粉丝</div>
    </div>
</div>
    <div class="flex flex1 column">
        <div th:each="follow,followStat : ${follows}" class="flex m-backcolor" style="margin-bottom: 1px">
            <img th:src="${follow.getPortrait()}" alt="" class="m-headPicture-circle m-mg8" style="width: 30px;height: 30px" src="https://maomao-image.oss-cn-guangzhou.aliyuncs.com/img/20220801204640.png">
            <div class="flex column m-mg8">
                <input th:value="${follow.getId()}" hidden="true" name="followId"/>
                <div th:text="${follow.getNickname()}" style="font-size: 13px" >毛毛</div>
                <div th:text="${follow.getIntroduce()}" class="m-font-gray" style="font-size: 10px">这是关注列表</div>
            </div>
            <div class="flex1" style="text-align: right">
                <button th:if="${followStat.index <= followSize - 1}" value="1" name="follow-btn" class="m-cancelFollow" style="margin-right: 8px;margin-top: 14px">取关</button>
                <button th:if="${followStat.index > followSize - 1}" value="0" name="follow-btn" style="margin-right: 8px;margin-top: 14px">关注</button>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="../static/js/jquery-2.0.3.js" th:src="@{/js/jquery-2.0.3.js}"></script>
<script>
    $("[name= 'follow-btn']").click(function (e) {
        this.value === "0" ? addFollow(e) : removeFollow(e);
    })

    addFollow = function(e) {
        let followId = e.target.parentElement.previousElementSibling.firstElementChild.value;
        $.ajax({
            url:"/addFollow/" + followId,
            type : 'GET',
            dataType : 'text',
            success :function(data){
                //发送成功改变按钮
                e.target.className = "m-cancelFollow";
                e.target.value = 1;
                e.target.innerText = "取关";
            }
        })
    }

    removeFollow = function (e) {
        let followId = e.target.parentElement.previousElementSibling.firstElementChild.value;
        $.ajax({
            url:"/removeFollow/" + followId,
            type : 'GET',
            dataType : 'text',
            success :function(data){
                //发送成功改变按钮
                e.target.removeAttribute("class","m-cancelFollow");
                e.target.value = 0;
                e.target.innerText = "关注";
            }
        })
    }
</script>

</html>